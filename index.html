<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Coach Perte de Gras</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      margin: 0; padding: 0;
      display: flex; flex-direction: column;
      height: 100vh;
    }
    #chat {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
    }
    .message {
      margin: 10px 0;
      padding: 10px;
      border-radius: 8px;
      max-width: 70%;
    }
    .user {
      background-color: #d1e7dd;
      align-self: flex-end;
    }
    .bot {
      background-color: #e2e3e5;
      align-self: flex-start;
    }
    #inputArea {
      display: flex;
      padding: 10px;
      border-top: 1px solid #ccc;
      background: white;
    }
    input {
      flex: 1;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    button {
      margin-left: 10px;
      padding: 10px;
      font-size: 16px;
      background-color: #198754;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="chat"></div>
  <div id="inputArea">
    <input type="text" id="userInput" placeholder="Pose ta question..." />
    <button onclick="sendMessage()">Envoyer</button>
  </div>

  <script>
    const chat = document.getElementById('chat');
    const input = document.getElementById('userInput');

    const API_KEY = "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";

    const systemPrompt = "Tu es Coach Perte de Gras, un expert en nutrition et perte de poids durable. Tu proposes des plans simples, motivants, adaptés aux habitudes de la personne, en français, avec un ton chaleureux, professionnel et encourageant.";

    async function sendMessage() {
      const userMessage = input.value.trim();
      if (!userMessage) return;

      appendMessage(userMessage, 'user');
      input.value = '';

      appendMessage("...", 'bot');

      const messages = [
        { role: "system", content: systemPrompt },
        { role: "user", content: userMessage }
      ];

      try {
        const response = await fetch("https://api.openai.com/v1/chat/completions", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": `Bearer ${API_KEY}`
          },
          body: JSON.stringify({
            model: "gpt-3.5-turbo",
            messages: messages,
            temperature: 0.7
          })
        });

        const data = await response.json();
        const botMessage = data.choices?.[0]?.message?.content || "Erreur de réponse.";

        const botDivs = document.querySelectorAll('.bot');
        const lastBot = botDivs[botDivs.length - 1];
        lastBot.innerText = botMessage;

      } catch (err) {
        const botDivs = document.querySelectorAll('.bot');
        const lastBot = botDivs[botDivs.length - 1];
        lastBot.innerText = "Une erreur est survenue. Vérifie ta clé API.";
      }
    }

    function appendMessage(text, sender) {
      const div = document.createElement('div');
      div.className = `message ${sender}`;
      div.innerText = text;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
    }
  </script>
</body>
</html>


